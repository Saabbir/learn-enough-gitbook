# ğŸ“˜ Shopify OAuth Flow (Step by Step, With URLs)

## Goal of this article

By the end, you will:

* Manually construct the **Shopify install URL**
* Understand **every OAuth query parameter**
* Know exactly what `/install` must do
* Understand where `state` comes from and why it matters
* Be mentally ready to write your **first real Shopify OAuth route**

No code yet â€” but this is **implementation-level understanding**.



## Reminder: Where We Are in the Flow

We are focusing on **this part only**:

```
Merchant â†’ Shopify â†’ Your /install route â†’ Shopify permission screen
```

Not callback yet. One step at a time.



## Step 0 â€” What Triggers OAuth?

OAuth **always** starts when a merchant tries to install your app.

That means:

* Clicking â€œInstall appâ€ in Shopify Admin
* Or visiting your app install URL manually

Either way, Shopify sends the merchant to **your backend** first.



## Step 1 â€” Shopify Redirects to `/install`

Example request hitting your server:

```
GET /install?shop=my-store.myshopify.com
```

Important:

* Shopify only sends **shop**
* No token yet
* No permission yet

At this moment, your app knows only one thing:

> â€œWhich store wants to install meâ€

### What Your `/install` Route Must Do

Your `/install` route has **one job**:

> Redirect the merchant **back to Shopify**,\
> asking for permission.

Nothing more.

No database.\
No API calls.\
No token.

Just a redirect.



## Step 2 â€” Build the Shopify Authorization URL

This is the **core OAuth URL**.

It looks like this:

```
https://{shop}/admin/oauth/authorize
```

Replace `{shop}` with:

```
my-store.myshopify.com
```

So base URL becomes:

```
https://my-store.myshopify.com/admin/oauth/authorize
```

This URL opens Shopifyâ€™s **permission screen**.



## Step 3 â€” Add Required Query Parameters

Shopify requires **four main parameters**.

Letâ€™s add them one by one.

#### 1ï¸âƒ£ `client_id`

This is your **App API Key**.

Example:

```
client_id=abcd1234
```

Meaning:

> â€œWhich app is asking for permission?â€

Shopify uses this to identify your app.

***

#### 2ï¸âƒ£ `scope`

Scopes define **what your app can access**.

Example:

```
scope=read_products,write_products
```

Meaning:

> â€œThis app wants to read and write products.â€

Important:

* You must ask for **minimum required scopes**
* Merchants see these on the permission screen

***

#### 3ï¸âƒ£ `redirect_uri`

This tells Shopify:

> â€œWhere should I send the merchant after approval?â€

Example:

```
redirect_uri=https://your-app.com/auth/callback
```

This **must exactly match** what you configure in app settings.

Even a missing slash âŒ breaks OAuth.

***

#### 4ï¸âƒ£ `state` (Very Important)

`state` is:

* A random string
* Generated by **your app**
* Stored temporarily (cookie / memory)

Example:

```
state=abc123xyz
```

Purpose:

* Prevents CSRF attacks
* Ensures callback belongs to this request

If state doesnâ€™t match later â†’ reject.



### Full Authorization URL (Assembled)

Putting it all together:

```
https://my-store.myshopify.com/admin/oauth/authorize
?client_id=abcd1234
&scope=read_products,write_products
&redirect_uri=https://your-app.com/auth/callback
&state=random_string
```

This is the **exact URL** your `/install` route redirects to.



## Step 4 â€” Merchant Sees Permission Screen

Shopify shows:

* App name
* Requested scopes
* Approve / Cancel buttons

Merchant clicks **Approve**.

This is **explicit consent**.

### Critical Insight

Up to this point:

âŒ No token\
âŒ No API access\
âŒ No database write

OAuth is still **in progress**.



## Visualizing This Half of OAuth

![Image](https://cdn.shopify.com/s/files/1/0533/2089/files/shopify_oauth_1.png?1440=)

![Image](https://cdn.shopify.com/shopifycloud/shopify-dev/production/assets/assets/images/api/oauth-app-permissions-DSjN6fSO.png)

![Image](https://cdn.shopify.com/shopifycloud/shopify-dev/production/assets/assets/images/apps/oauth-BVV3KNFj.png)

Flow so far:

1. Merchant clicks install
2. Shopify â†’ `/install`
3. Your app â†’ Shopify authorize URL
4. Merchant approves



## Why Shopify Needs `redirect_uri`

Because Shopify must:

* Know where your server lives
* Safely return control
* Avoid phishing apps

This is **platform-level security**.



## Why `state` Is Mandatory (Not Optional)

Imagine this attack:

* Malicious site sends fake callback to your app
* Your app blindly accepts it

`state` prevents this.

Rule:

> If `state` in callback â‰  `state` you sent â†’ reject immediately

Weâ€™ll enforce this in code later.



## What `/install` Does NOT Do

Very important:

âŒ It does NOT call Shopify APIs\
âŒ It does NOT store tokens\
âŒ It does NOT verify HMAC\
âŒ It does NOT touch database

It only:

> Validates `shop`\
> Redirects to Shopify

One responsibility.



## Mental Checklist for `/install`

When you later write code, `/install` should:

* [ ] Validate `shop` param exists
* [ ] Generate `state`
* [ ] Save `state` temporarily
* [ ] Build authorize URL
* [ ] Redirect merchant

Thatâ€™s it.



## One Sentence That Locks It In

Repeat this:

> `/install` is just a smart redirect to Shopifyâ€™s permission screen.

If you remember that, youâ€™ll never overcomplicate it.



## âœ… What You Should Understand Now

You should now be crystal clear on:

* How OAuth starts
* What `/install` does
* How to build Shopifyâ€™s authorize URL
* What `client_id`, `scope`, `redirect_uri`, `state` mean
* Why no token exists yet

You are now **ready to code `/install`**.



## â¡ï¸ Next Article â€” Implementing `/install` Route

Next we will:

* Write `/install` **line by line**
* Validate shop domains
* Generate and store `state`
* Redirect properly
* Test the flow manually

This is your **first real Shopify OAuth code** ğŸš€
